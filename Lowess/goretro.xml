<?xml version="1.0"?>
<Container version="2">
	<Name>GoRetro</Name>
	<Repository>lowess/goretro</Repository>
	<Registry>https://hub.docker.com/r/lowess/goretro/</Registry>
	<Network>bridge</Network>
	<Privileged>false</Privileged>
	<Support>https://github.com/Lowess/goretro/issues</Support>
	<Overview>
		GoRetro - REST API server for managing retro gaming ROM collections. Generate gamelist XML files, scrape metadata from ScreenScraper, download media, and manage favorites via HTTP API endpoints.
	</Overview>
	<Category>Tools:</Category>
	<WebUI>http://[IP]:[PORT:8080]</WebUI>
	<TemplateURL>
		https://raw.githubusercontent.com/Lowess/docker-templates-unraid/main/Lowess/goretro.xml</TemplateURL>
	<Icon>
		https://raw.githubusercontent.com/Lowess/docker-templates-unraid/main/Lowess/images/goretro.png</Icon>
	<ExtraParams></ExtraParams>
	<PostArgs>serve</PostArgs>
	<Description>
		GoRetro provides a REST API for managing ROM collections with ScreenScraper integration.

		FEATURES:
		- Generate gamelist.xml files for any system via API
		- Scrape individual game metadata
		- Manage favorite ROMs
		- Automatic metadata enrichment and media downloads
		- Smart caching system for faster re-runs

		API ENDPOINTS:
		- POST /api/generate/{system} - Generate gamelist (no request body needed!)
		- POST /api/scrape - Scrape metadata for a specific game
		- GET/PUT/DELETE /api/favorites - Manage favorite ROMs

		CONFIGURATION:
		GoRetro uses a config.yaml file located at:
		  /mnt/user/appdata/goretro/config.yaml

		On first run, copy the example config:
		  cp /mnt/user/appdata/goretro/config.yaml.example /mnt/user/appdata/goretro/config.yaml
		  nano /mnt/user/appdata/goretro/config.yaml

		The config file contains:
		- ScreenScraper credentials (required for scraping)
		- Server settings (port, bind address, base ROM directory)
		- Default API behavior (scraping, media downloads, etc.)

		USAGE:
		1. Copy and edit config.yaml in your appdata folder
		2. Start the container - it runs a persistent HTTP server
		3. Access the API at http://[IP]:8080
		4. Make API calls - most can be done with just: POST /api/generate/{system}

		IMPORTANT - FILE PERMISSIONS:
		The container runs as UID 1000 / GID 1000 for security. If you get "permission denied"
		errors when generating gamelists, fix ownership:

		  chown -R 1000:1000 /mnt/user/data/media/roms

		Or for specific systems:
		  chown -R 1000:1000 /mnt/user/data/media/roms/snes

		Your ROM directory structure should be:
		  /mnt/user/data/media/roms/
		    ├── snes/
		    │   ├── *.sfc, *.smc files
		    │   └── gamelist.xml (generated)
		    ├── nes/
		    └── gba/
	</Description>
	<Beta>False</Beta>
	<Project>https://github.com/Lowess/goretro</Project>
	<Date>2025-01-04</Date>
	<Changes>
		###v2.1.0 (2025-01-11)
		- NEW: Configuration via config.yaml file (cleaner than env vars)
		- NEW: rom_dir is now optional - defaults to /roms/{system}
		- IMPROVED: Enhanced CORS support for reverse proxies
		- IMPROVED: Better error messages with troubleshooting tips
		- IMPROVED: Automatic path resolution and validation
		- FIX: Permission denied errors now show full paths
		- BREAKING: Most environment variables deprecated in favor of config.yaml

		###v2.0.0 (2025-01-10)
		- NEW: HTTP API server mode (goretro serve)
		- NEW: REST endpoints for generate, scrape, and favorites
		- NEW: Persistent favorites management
		- Environment variables now serve as API defaults
		- Container runs as persistent service instead of one-time execution
		- Access API at http://[IP]:8080

		###v1.1.0 (2025-01-04)
		- Simplified path structure - single mount point
		- Fixed media path duplication issue
		- Container now stays visible in Unraid after completion
		- Clearer configuration options

		###v1.0.0 (2025-01-03)
		- Initial release with scraping and media download support
		- Live progress dashboard
		- Parallel media downloads
		- Smart caching system
		- Multi-system support (50+ systems)
	</Changes>
	<Networking>
		<Mode>bridge</Mode>
	</Networking>

	<!-- Server Configuration -->
	<Config Type="Port" Name="API Server Port"
		Target="8080"
		Default="8080"
		Mode="tcp"
		Description="Port for the GoRetro HTTP API server. Access API at http://[IP]:[PORT]"
		Display="always"
		Required="true">8080</Config>

	<!-- Path Mappings -->
	<Config Type="Path" Name="ROM Directory" Target="/roms"
		Default="/mnt/user/data/media/roms"
		Mode="rw"
		Description="Base ROM directory containing system subdirectories (snes/, nes/, etc.). GoRetro reads ROMs from /roms/{system}/ and writes gamelist.xml and media to the same location."
		Display="always"
		Required="true" Mask="false">/mnt/user/data/media/roms</Config>

	<Config Type="Path" Name="Config Directory" Target="/config"
		Default="/mnt/user/appdata/goretro"
		Mode="rw"
		Description="Configuration directory. Contains config.yaml (edit this!), favorites.yaml, and .cache/ subdirectory. Copy config.yaml.example to config.yaml on first run."
		Display="always"
		Required="true" Mask="false">/mnt/user/appdata/goretro</Config>
</Container>
